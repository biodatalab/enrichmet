Checking for deprecated package usage... OK
Checking for remote package usage... OK
Checking for 'LazyData: true' usage... OK
Checking version number... OK
Checking version number validity... OK
Checking R version dependency... OK
Checking package size... OK
Checking individual file sizes... OK
Checking biocViews... OK
Checking that biocViews are present... OK
Checking package type based on biocViews... OK
Checking for non-trivial biocViews... OK
Checking that biocViews come from the same category... OK
Checking biocViews validity... OK
Checking for recommended biocViews... OK
Checking build system compatibility... OK
Checking for proper Description: field... OK
Checking if DESCRIPTION is well formatted... OK
Checking for whitespace in DESCRIPTION field names... OK
Checking that Package field matches directory/tarball name... OK
Checking for Version: field... OK
Checking for valid maintainer... OK
Checking License: for restrictive use... OK
Checking for recommended DESCRIPTION fields... OK
Checking for Bioconductor software dependencies... OK
Checking for pinned package versions in DESCRIPTION... OK
Checking for 'fnd' role in Authors@R... OK
Checking NAMESPACE... OK
Checking .Rbuildignore... OK
Checking for stray BiocCheck output folders... OK
Checking for inst/doc folders... OK
Checking vignette directory...
 Vignette(s) found with missing chunk labels
Found in files:
Tutorial.Rmd
Checking package installation calls in R code... OK
Checking for library/require of enrichmet... OK
Checking coding practice...
 Avoid sapply(); use vapply()
Found in files:
R/perform_enrichment_analysis.R (line 127, column 22)
Checking parsed R code in R directory, examples, vignettes... OK
Checking function lengths...
The recommended function length is 50 lines or less. There are 7 functions greater than 50 lines.
The longest 5 functions are:
enrichmet() (R/enrichmet.R): 152 lines
create_interaction_plot() (R/create_interaction_plot.R): 106 lines
perform_enrichment_analysis() (R/perform_enrichment_analysis.R):  83 lines
create_heatmap_plot() (R/create_heatmap_plot.R):  82 lines
prepare_gmt_data() (R/prepare_gmt_data.R):  70 lines
Checking man page documentation... OK
Checking package NEWS... OK
Checking unit tests... OK
Checking skip_on_bioc() in tests... OK
Checking formatting of DESCRIPTION, NAMESPACE, man pages, R source, and vignette source...
Consider shorter lines; 167 lines (9%) are > 80 characters long.
First few lines:
R/calculate_metabolite_centrality.R#L5 #' @param PathwayVsMetabolites A data fr ...
R/calculate_metabolite_centrality.R#L8 #' @return A data frame with metabolite  ...
R/calculate_metabolite_centrality.R#L29         stop("PathwayVsMetabolites must  ...
R/calculate_metabolite_centrality.R#L43     g_metabolites <- igraph::graph_from_ ...
R/calculate_metabolite_centrality.R#L44     betweenness_metabolites <- igraph::b ...
R/create_centrality_plot.R#L26 #'            "Fructose-6P", "Glucose-6P ...
R/create_centrality_plot.R#L28 #'            "Xylulose-5P", "Ribulose-5 ...
R/create_centrality_plot.R#L33 #' plot <- create_centrality_plot(centra ...
R/create_centrality_plot.R#L37 #' @importFrom ggplot2 ggplot aes geom_c ...
R/create_centrality_plot.R#L41 create_centrality_plot <- function(centr ...
R/create_centrality_plot.R#L65             title = paste("Top", top_n,  ...
R/create_enrichment_plot.R#L45 #' @importFrom ggplot2 ggplot aes geom_p ...
R/create_gsea_plot.R#L32 #'   input_count = c(15, 12, 10, 9, 8, 7 ...
R/create_heatmap_plot.R#L6 #' @param PathwayVsMetabolites A data fr ...
R/create_heatmap_plot.R#L32 #'   Metabolites = c("C00031,C00022,C000 ...
R/create_heatmap_plot.R#L41 #' inputMetabolites <- c("C00031", "C000 ...
R/create_heatmap_plot.R#L42 #'                      "C00186", "C0022 ...
R/create_heatmap_plot.R#L43 #'                      "C00158", "C0011 ...
R/create_heatmap_plot.R#L51 #'   name = c("D-Glucose", "L-Lactate",  ...
R/create_heatmap_plot.R#L52 #'            "3-Phospho-D-glyceroyl pho ...
R/create_heatmap_plot.R#L63 #' heatmap_plot <- create_heatmap_plot(e ...
R/create_heatmap_plot.R#L76 create_heatmap_plot <- function(enrichme ...
R/create_heatmap_plot.R#L107         warning("No common pathways foun ...
R/create_impact_plot.R#L31 #'                       0.0087, 0.012,  ...
R/create_impact_plot.R#L38 #' @importFrom ggplot2 ggplot aes geom_p ...
R/create_interaction_plot.R#L56 #' plot <- create_interaction_plot(input ...
R/create_interaction_plot.R#L60 #' @importFrom igraph graph_from_data_fr ...
R/create_interaction_plot.R#L61 #' @importFrom ggraph ggraph geom_edge_l ...
R/create_interaction_plot.R#L65 create_interaction_plot <- function(inpu ...
R/create_interaction_plot.R#L67         warning("STITCH interaction anal ...
R/create_interaction_plot.R#L105         d = valid_edges %>% dplyr::mutat ...
R/create_interaction_plot.R#L108             dplyr::filter(STITCH_ID %in% ...
R/create_interaction_plot.R#L130         ggraph::geom_edge_link(aes(width ...
R/create_interaction_plot.R#L131         ggraph::geom_node_point(aes(size ...
R/create_interaction_plot.R#L165             plot.title = element_text(hj ...
R/create_membership_plot.R#L5 #' @param PathwayVsMetabolites A data fr ...
R/create_membership_plot.R#L49 #'            "L-Cystathionine", "L-Homo ...
R/create_membership_plot.R#L53 #' plot <- create_membership_plot(Pathwa ...
R/create_membership_plot.R#L63 create_membership_plot <- function(Pathw ...
R/create_network_plot.R#L6 #' @param PathwayVsMetabolites A data fr ...
R/create_network_plot.R#L19 #'   Metabolites = c("C00031,C00022,C001 ...
R/create_network_plot.R#L36 #'            "NAD+", "NADH", "Coenzyme  ...
R/create_network_plot.R#L40 #' plot <- create_network_plot(inputMeta ...
R/create_network_plot.R#L46 #' @importFrom ggraph ggraph geom_edge_l ...
R/create_network_plot.R#L48 create_network_plot <- function(inputMet ...
R/create_network_plot.R#L63     node_centrality <- igraph::betweenne ...
R/create_network_plot.R#L66     igraph::V(g)$type <- ifelse(igraph:: ...
R/create_network_plot.R#L103             subtitle = paste("Showing",  ...
R/enrichmet.R#L72 #' A modular tool for metabolite pathway ...
R/enrichmet.R#L73 #' analytical tasks including pathway en ...
R/enrichmet.R#L74 #' network centrality analysis, and inte ...
R/enrichmet.R#L77 #' @param inputMetabolites A character v ...
R/enrichmet.R#L78 #'        for which pathway enrichment a ...
R/enrichmet.R#L79 #' @param PathwayVsMetabolites A data fr ...
R/enrichmet.R#L81 #' @param example_data A data frame cont ...
R/enrichmet.R#L82 #'        Should include columns "met_id ...
R/enrichmet.R#L83 #' @param top_n An integer specifying th ...
R/enrichmet.R#L84 #'        pathway enrichment results (de ...
R/enrichmet.R#L85 #' @param p_value_cutoff A numeric value ...
R/enrichmet.R#L87 #' @param kegg_lookup Optional data fram ...
R/enrichmet.R#L89 #' @param mapping_df Optional data frame ...
R/enrichmet.R#L91 #' @param stitch_df Optional data frame  ...
R/enrichmet.R#L92 #'        STITCH IDs and chemical-chemic ...
R/enrichmet.R#L94 #' @param output_dir Optional directory  ...
R/enrichmet.R#L98 #' @param analysis_type Character vector ...
R/enrichmet.R#L99 #'        "enrichment" (pathway enrichme ...
R/enrichmet.R#L100 #'        "centrality" (network centrali ...
R/enrichmet.R#L101 #'        "interaction" (chemical intera ...
R/enrichmet.R#L106 #' @return A list containing results fro ...
R/enrichmet.R#L108 #'   \item \code{pathway_enrichment_resu ...
R/enrichmet.R#L110 #'   \item \code{metabolite_centrality}  ...
R/enrichmet.R#L111 #'   \item \code{pathway_plot} - ggplot  ...
R/enrichmet.R#L116 #'   \item \code{heatmap_plot} - Complex ...
R/enrichmet.R#L118 #'   \item \code{interaction_plot} - ggr ...
R/enrichmet.R#L124 #' specific analyses. See the individual ...
R/enrichmet.R#L153 #'   Pathway = c("Pathway101", "Pathway1 ...
R/enrichmet.R#L176 #'   STITCH_ID = paste0("CIDs", stringr: ...
R/enrichmet.R#L181 #' stitch_pairs <- expand.grid(chemical1 ...
R/enrichmet.R#L204 #'   analysis_type = c("enrichment", "gs ...
R/enrichmet.R#L231                       analysis_type = c( ...
R/enrichmet.R#L241         stop("PathwayVsMetabolites must  ...
R/enrichmet.R#L248     valid_analyses <- c("enrichment", "g ...
R/enrichmet.R#L250         stop("analysis_type must contain ...
R/enrichmet.R#L270             results$pathway_plot <- crea ...
R/enrichmet.R#L271             results$impact_plot <- creat ...
R/enrichmet.R#L282             gsea_results <- perform_gsea ...
R/enrichmet.R#L286                 results$gsea_plot <- cre ...
R/enrichmet.R#L305                 dplyr::left_join(kegg_lo ...
R/enrichmet.R#L306                 dplyr::mutate(Display_Na ...
R/enrichmet.R#L315             results$rbc_plot <- create_c ...
R/enrichmet.R#L322         results$network_plot <- create_n ...
R/enrichmet.R#L328         if ("enrichment" %in% analysis_t ...
R/enrichmet.R#L341         results$membership_plot <- creat ...
R/enrichmet.R#L347         results$interaction_plot <- crea ...
R/enrichmet.R#L352         if ("enrichment" %in% analysis_t ...
R/enrichmet.R#L353             output_file1 <- file.path(ou ...
R/enrichmet.R#L354             openxlsx::write.xlsx(results ...
R/enrichmet.R#L364         if ("centrality" %in% analysis_t ...
R/enrichmet.R#L365             output_file3 <- file.path(ou ...
R/perform_enrichment_analysis.R#L3 #' Uses Fisher's exact test to identify  ...
R/perform_enrichment_analysis.R#L5 #' @param inputMetabolites A character v ...
R/perform_enrichment_analysis.R#L7 #' @param PathwayVsMetabolites A data fr ...
R/perform_enrichment_analysis.R#L9 #' @param top_n An integer specifying th ...
R/perform_enrichment_analysis.R#L10 #' @param p_value_cutoff A numeric value ...
R/perform_enrichment_analysis.R#L13 #' @return A data frame of pathway enric ...
R/perform_enrichment_analysis.R#L25 #' results <- perform_enrichment_analysi ...
R/perform_enrichment_analysis.R#L42         stop("PathwayVsMetabolites must  ...
R/perform_enrichment_analysis.R#L53     metabolite_centrality <- calculate_m ...
R/perform_enrichment_analysis.R#L67         d <- length(setdiff(allMetabolit ...
R/perform_enrichment_analysis.R#L70         fisher_test_result <- fisher.tes ...
R/perform_enrichment_analysis.R#L81             sum(matched_centrality$RBC_M ...
R/perform_gsea_analysis.R#L5 #' @param example_data A data frame cont ...
R/perform_gsea_analysis.R#L7 #' @param PathwayVsMetabolites A data fr ...
R/perform_gsea_analysis.R#L10 #' @return A data frame of GSEA results  ...
R/perform_gsea_analysis.R#L37         stop("example_data must be a dat ...
R/perform_gsea_analysis.R#L42         stop("PathwayVsMetabolites must  ...
R/perform_gsea_analysis.R#L54     rankings <- sign(example_filtered_da ...
R/prepare_gmt_data.R#L5 #' @param PathwayVsMetabolites A data fr ...
R/prepare_gmt_data.R#L7 #' @param metabolites_in_data Optional c ...
R/prepare_gmt_data.R#L28         stop("PathwayVsMetabolites must  ...
R/prepare_gmt_data.R#L32     PathwayVsMetabolites$description <-  ...
vignettes/Tutorial.Rmd#L10   %\VignetteIndexEntry{1. Quick and Easy ...
vignettes/Tutorial.Rmd#L18 Advances in metabolomics have enhanced o ...
vignettes/Tutorial.Rmd#L20 **enrichmet** streamlines pathway enrich ...
vignettes/Tutorial.Rmd#L33 The enrichmet() function produces three  ...
vignettes/Tutorial.Rmd#L54 To run the **enrichmet** package, you ne ...
vignettes/Tutorial.Rmd#L57 This file defines the mapping between me ...
vignettes/Tutorial.Rmd#L59 The mappings are derived from the KEGG d ...
vignettes/Tutorial.Rmd#L61   [Human-PathwaysVsMetabolites.csv](http ...
vignettes/Tutorial.Rmd#L65 A list of metabolites from the user’s ex ...
vignettes/Tutorial.Rmd#L67 For demonstration purposes, we also incl ...
vignettes/Tutorial.Rmd#L71 The enrichment analysis requires statist ...
vignettes/Tutorial.Rmd#L73 This information is not generated by the ...
vignettes/Tutorial.Rmd#L75 For demonstration purposes, the package  ...
vignettes/Tutorial.Rmd#L77 The **enrichmet**() function integrates  ...
vignettes/Tutorial.Rmd#L81 Including these optional files can enhan ...
vignettes/Tutorial.Rmd#L84   A reference file linking KEGG compound ...
vignettes/Tutorial.Rmd#L86   [kegg_lookup.xlsx](https://zenodo.org/ ...
vignettes/Tutorial.Rmd#L90 A dataset of known or predicted interact ...
vignettes/Tutorial.Rmd#L91 ). These interactions are useful for con ...
vignettes/Tutorial.Rmd#L93   [chemical_chemical.tsv](https://zenodo ...
vignettes/Tutorial.Rmd#L97   A mapping data frame that links STITCH ...
vignettes/Tutorial.Rmd#L99   [mapping_df.xlsx](https://zenodo.org/a ...
vignettes/Tutorial.Rmd#L100   Users can substitute this with a mappi ...
vignettes/Tutorial.Rmd#L105 We used summary statistics from differen ...
vignettes/Tutorial.Rmd#L134 pathway_url <- "https://zenodo.org/api/r ...
vignettes/Tutorial.Rmd#L140 example_url <- "https://zenodo.org/api/r ...
vignettes/Tutorial.Rmd#L146 kegg_url <- "https://zenodo.org/api/reco ...
vignettes/Tutorial.Rmd#L152 mapping_url <- "https://zenodo.org/api/r ...
vignettes/Tutorial.Rmd#L176 ```{r display-plots1, results='asis', fi ...
vignettes/Tutorial.Rmd#L179 Fig. 1. Pathway enrichment plot. The plo ...
vignettes/Tutorial.Rmd#L181 ```{r display-plots2, results='asis', fi ...
vignettes/Tutorial.Rmd#L185 Fig. 2. Pathway impact plot. The plot in ...
vignettes/Tutorial.Rmd#L187 ```{r display-plots3, results='asis', fi ...
vignettes/Tutorial.Rmd#L190 Fig. 3. Metabolite Set Enrichment Analys ...
vignettes/Tutorial.Rmd#L192 ```{r display-plots4, results='asis', fi ...
vignettes/Tutorial.Rmd#L195 Fig. 4. Relative Betweenness Plot. This  ...
vignettes/Tutorial.Rmd#L196 ```{r display-plots5, results='asis', fi ...
vignettes/Tutorial.Rmd#L199 Fig. 5. Pathway–Metabolite Network Plot. ...
vignettes/Tutorial.Rmd#L200 ```{r display-plots6, results='asis', fi ...
vignettes/Tutorial.Rmd#L203 Fig. 6. Pathway Heatmap. Metabolites are ...
vignettes/Tutorial.Rmd#L205 ```{r display-plots7, results='asis', fi ...
vignettes/Tutorial.Rmd#L210 Fig. 7. Pathway Membership plot. Metabol ...
vignettes/Tutorial.Rmd#L211 ```{r display-plots8, results='asis', fi ...
vignettes/Tutorial.Rmd#L214 Fig. 8. Chemical-Chemical Interaction pl ...
vignettes/Tutorial.Rmd#L218 1. Kanehisa, M., Furumichi, M., Sato, Y. ...
vignettes/Tutorial.Rmd#L220 2. Szklarczyk, D., Santos, A., von Merin ...
Consider multiples of 4 spaces for line indents; 43 lines (2%) are not.
First few lines:
R/create_heatmap_plot.R#L86                       Metabolites %in% i ...
R/create_network_plot.R#L78                    metabolite_names[igra ...
R/create_network_plot.R#L79                    igraph::V(g)$name), ...
R/enrichmet.R#L222                       PathwayVsMetabolit ...
R/enrichmet.R#L223                       example_data = NUL ...
R/enrichmet.R#L224                       top_n = 100, ...
R/enrichmet.R#L225                       p_value_cutoff = 1 ...
R/enrichmet.R#L226                       kegg_lookup = NULL ...
R/enrichmet.R#L227                       mapping_df = NULL, ...
R/enrichmet.R#L228                       stitch_df = NULL, ...
R/enrichmet.R#L229                       output_dir = NULL, ...
R/enrichmet.R#L230                       save_excel = FALSE ...
R/enrichmet.R#L231                       analysis_type = c( ...
R/enrichmet.R#L232                       run_plots = TRUE)  ...
vignettes/Tutorial.Rmd#L60   We provide a human-specific `PathwayVs ...
vignettes/Tutorial.Rmd#L61   [Human-PathwaysVsMetabolites.csv](http ...
vignettes/Tutorial.Rmd#L62   However, users can supply a file tailo ...
vignettes/Tutorial.Rmd#L84   A reference file linking KEGG compound ...
vignettes/Tutorial.Rmd#L85   We provide a KEGGLookup file here:   ...
vignettes/Tutorial.Rmd#L86   [kegg_lookup.xlsx](https://zenodo.org/ ...
vignettes/Tutorial.Rmd#L87   Users may also provide a lookup file s ...
vignettes/Tutorial.Rmd#L92   We supply an example file here:   ...
vignettes/Tutorial.Rmd#L93   [chemical_chemical.tsv](https://zenodo ...
vignettes/Tutorial.Rmd#L94   Users may provide their own interactio ...
vignettes/Tutorial.Rmd#L97   A mapping data frame that links STITCH ...
vignettes/Tutorial.Rmd#L98   The provided example file is available ...
vignettes/Tutorial.Rmd#L99   [mapping_df.xlsx](https://zenodo.org/a ...
vignettes/Tutorial.Rmd#L100   Users can substitute this with a mappi ...
vignettes/Tutorial.Rmd#L110   "C02721", "C03736", "C03139", "C00074" ...
vignettes/Tutorial.Rmd#L111   "C00386", "C10172", "C00361", "C00242" ...
vignettes/Tutorial.Rmd#L112   "C16353", "C02140", "C05488", "C01181" ...
vignettes/Tutorial.Rmd#L113   "C00079", "C08317", "C00588", "C16527" ...
vignettes/Tutorial.Rmd#L114   "C02990", "C03690", "C04025", "C06424" ...
vignettes/Tutorial.Rmd#L115   "C00539", "C00633", "C00519", "C00366" ...
vignettes/Tutorial.Rmd#L116   "C00385", "C06429", "C05637", "C00295" ...
vignettes/Tutorial.Rmd#L117   "C03299", "C01530", "C01571", "C08278" ...
vignettes/Tutorial.Rmd#L118   "C03739" ...
vignettes/Tutorial.Rmd#L126   bfcrpath(bfc, url) ...
vignettes/Tutorial.Rmd#L165   inputMetabolites = inputMetabolites, ...
vignettes/Tutorial.Rmd#L166   PathwayVsMetabolites = PathwayVsMetabo ...
vignettes/Tutorial.Rmd#L167   top_n = 100,p_value_cutoff = 0.05, ...
vignettes/Tutorial.Rmd#L168   mapping_df = mapping_df, ...
vignettes/Tutorial.Rmd#L169   stitch_df = stitch_df ...
Checking if package already exists in CRAN... OK
Checking for bioc-devel mailing list subscription...
Cannot determine whether maintainer is subscribed to the Bioc-Devel mailing list (requires admin credentials). Subscribe here: https://stat.ethz.ch/mailman/listinfo/bioc-devel
Checking for support site registration... OK
