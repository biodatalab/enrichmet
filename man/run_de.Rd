% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_de.R
\name{run_de}
\alias{run_de}
\title{Run Differential Expression Analysis using LIMMA}
\usage{
run_de(
  df,
  group1_pattern,
  group2_pattern,
  plot_volcano = TRUE,
  top_n_labels = 20,
  fc_threshold = 1,
  pval_threshold = 0.05,
  min_samples = 3,
  split_complex_ids = TRUE
)
}
\arguments{
\item{df}{A data frame or matrix with metabolites as rows and samples as columns. 
Rownames should be metabolite identifiers.}

\item{group1_pattern}{Character string pattern to identify samples in group 1}

\item{group2_pattern}{Character string pattern to identify samples in group 2}

\item{plot_volcano}{Logical indicating whether to generate volcano plot (default: TRUE)}

\item{top_n_labels}{Number of top features to label in volcano plot (default: 20)}

\item{fc_threshold}{Fold change threshold for significance (default: 1)}

\item{pval_threshold}{P-value threshold for significance (default = 0.05)}

\item{min_samples}{Minimum number of samples required per group (default = 3)}

\item{split_complex_ids}{Logical indicating whether to split complex KEGG IDs like 
"C00025|C00979" into individual metabolites (default = TRUE)}
}
\value{
A list containing:
  \item{full_results}{Full results with all metabolites}
  \item{kegg_ready}{Results filtered for KEGG metabolites only}
  \item{volcano_plot}{ggplot object of volcano plot (if plot_volcano = TRUE)}
  \item{summary_stats}{Summary statistics of the analysis}
}
\description{
Performs differential expression analysis between two sample groups using LIMMA,
generates volcano plots, and prepares results for downstream enrichment analysis.
}
\examples{
# Example showing clear differential expression patterns
set.seed(123)

# Create data with 30 metabolites and 20 samples
n_metabolites <- 30
n_samples <- 20
simulated_data <- matrix(0, nrow = n_metabolites, ncol = n_samples)

# Control samples (columns 1-10)
simulated_data[, 1:10] <- rnorm(n_metabolites * 10, mean = 10, sd = 2)

# Treatment samples (columns 11-20) with clear patterns
simulated_data[1:5, 11:20] <- rnorm(5 * 10, mean = 15, sd = 2)   # Upregulated
simulated_data[6:10, 11:20] <- rnorm(5 * 10, mean = 5, sd = 2)    # Downregulated
simulated_data[11:30, 11:20] <- rnorm(20 * 10, mean = 10, sd = 2) # Not significant

# Set row and column names
rownames(simulated_data) <- paste0("Met_", 1:30)
colnames(simulated_data) <- c(paste0("Control_", 1:10), paste0("Treatment_", 1:10))

# Run differential expression analysis
results <- run_de(
  df = simulated_data,
  group1_pattern = "Control",
  group2_pattern = "Treatment",
  plot_volcano = TRUE,
  fc_threshold = 1,
  pval_threshold = 0.05
)

# View significant metabolites
sig_metabolites <- results$full_results[results$full_results$Significant != "Not significant", ]
head(sig_metabolites)

# View summary statistics
results$summary_stats
}
