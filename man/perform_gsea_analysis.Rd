% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/perform_gsea_analysis.R
\name{perform_gsea_analysis}
\alias{perform_gsea_analysis}
\title{Perform GSEA-style Pathway Enrichment Analysis}
\usage{
perform_gsea_analysis(
  example_data,
  PathwayVsMetabolites,
  minSize = 5,
  maxSize = 500,
  ranking_method = "signed_pval",
  id_col = NULL,
  pval_col = "pval",
  padj_col = "padj",
  log2fc_col = "log2fc",
  nperm = 1000,
  seed = NULL,
  kegg_lookup = NULL
)
}
\arguments{
\item{example_data}{A data frame containing metabolite statistics. Should contain:
- Either 'kegg_id' or 'met_id' column for metabolite identifiers
- 'log2fc' and 'pval' columns for ranking}

\item{PathwayVsMetabolites}{A data frame with pathway information containing 'Pathway' and 'Metabolites' columns.}

\item{minSize}{Minimum number of metabolites in a pathway to test (default = 5).}

\item{maxSize}{Maximum number of metabolites in a pathway to test (default = 500).}

\item{ranking_method}{Method for ranking metabolites. Options: "signed_pval" (default), 
"absolute_fc", or "pval_only".}

\item{id_col}{Column name in example_data containing metabolite IDs. 
Default is NULL (auto-detects 'kegg_id' or 'met_id').}

\item{pval_col}{Column name for p-values. Default is "pval".}

\item{padj_col}{Column name for adjusted p-values. Default is "padj".}

\item{log2fc_col}{Column name for log2 fold changes. Default is "log2fc".}

\item{nperm}{Number of permutations for GSEA. Default is 1000.}

\item{seed}{Random seed for reproducibility. Default is NULL.}

\item{kegg_lookup}{Optional data frame for KEGG ID to name mapping.}
}
\value{
A data frame containing the GSEA enrichment results with columns:
\itemize{
  \item pathway - Pathway name
  \item pval - Nominal p-value
  \item padj - Adjusted p-value (FDR)
  \item ES - Enrichment score
  \item NES - Normalized enrichment score
  \item nMoreExtreme - Number of permutations more extreme
  \item size - Size of the pathway after filtering
  \item leadingEdge - Metabolites driving the enrichment
  \item input_count - Number of metabolites from input data in pathway
  \item significance - Significance stars (*** p<0.001, ** p<0.01, * p<0.05, NS)
}
}
\description{
This function performs Gene Set Enrichment Analysis (GSEA) adapted for metabolomics data.
It tests whether predefined metabolite sets (pathways) show statistically significant
enrichment at the top or bottom of a ranked list of metabolites. Handles complex 
metabolite IDs by extracting clean KEGG IDs for pathway matching.
}
\examples{
# Example 1: Basic GSEA with simulated data
set.seed(123)
example_data <- data.frame(
  kegg_id = paste0("C", sprintf("\%05d", 1:100)),
  log2fc = rnorm(100, mean = 0, sd = 1),
  pval = runif(100, 0.001, 0.1)
)

# Create pathway data
PathwayVsMetabolites <- data.frame(
  Pathway = c("Pathway_A", "Pathway_B", "Pathway_C"),
  Metabolites = c("C00001,C00002,C00003,C00004,C00005,C00006,C00007",
                  "C00008,C00009,C00010,C00011,C00012,C00013,C00014", 
                  "C00015,C00016,C00017,C00018,C00019,C00020,C00021")
)

# Run GSEA
gsea_results <- perform_gsea_analysis(example_data, PathwayVsMetabolites)
head(gsea_results)

}
